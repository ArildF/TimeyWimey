@using TimeyWimey.Model
@using System.Text.Unicode
@inject TimeLineCalculator _lineCalculator;


@foreach (int halfHour in Enumerable.Range(0, 48))
{
    var y = _lineCalculator.HourVerticalPosition(halfHour);
    var height = _lineCalculator.HourVerticalPosition(halfHour + 1) - y;

    <rect y="@(y)%" height="@(height)%" width="100%" fill="lightgray" cursor="pointer" 
          class="align-content-stretch time-chunk"/>
    @if (halfHour % 2 == 0)
    {
        <text>
            <text class="hour" x="0" y="@(y -0.1)%">@($"{halfHour / 2}:00")</text>
        </text>
    }
    @if (halfHour == 17)
    {
        <line stroke-width="0" x1="0" y1="0" x2="0" y2="0" @ref="HourMark" tabindex="0"/>
    }
    double width = halfHour % 2 == 0 ? 0.3 : 0.1;
    <line stroke="black" x1="0%" x2="100%" y1="@(y)%"
          y2="@(y)%" stroke-width="@(width)px"/>
    
}
@if(Day?.Date == DateOnly.FromDateTime(DateTime.Today))
{
    <CurrentTimeLine/>
}

@code {
    [Parameter]
    public Day? Day { get; set; }

    
    public ElementReference HourMark { get; set; }

}
